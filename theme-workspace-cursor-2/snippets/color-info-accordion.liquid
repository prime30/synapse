{%- comment -%}
  Color Information Accordion Component

  Self-contained collapsible component for color matching information.
  Starts closed by default and includes all necessary CSS and JavaScript.
{%- endcomment -%}

<div class="color-info-accordion" data-color-accordion>
  <style>
    .color-info-accordion {
      margin: 0.75rem 0 0 0;
      padding: 0;
      border: none;
      border-bottom: 1px solid transparent;
      background: transparent;
      font-family: var(--pfd-font-family);
      font-size: 14px;
      line-height: 1.4;
      color: #333;
      box-sizing: border-box;
    }

    .color-info-accordion *,
    .color-info-accordion *::before,
    .color-info-accordion *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    .color-info-accordion h3 {
      display: flex;
      margin: 0;
      padding: 0;
      border: none;
      background: transparent;
      font-size: 14px;
      font-weight: 400;
      line-height: 1.4;
      color: inherit;
    }

    .color-info-accordion-button {
      display: flex;
      flex: 1;
      align-items: center;
      justify-content: space-between;
      margin: 0;
      padding: 8px 12px;
      border: none;
      border-radius: 0;
      background: transparent;
      font-family: var(--pfd-font-family);
      font-size: 14px;
      font-weight: 500;
      line-height: 1.4;
      color: #666;
      text-align: left;
      text-decoration: none;
      cursor: pointer;
      width: 100%;
      min-height: auto;
      box-shadow: none;
      outline: none;
      transition: color 0.2s ease;
      -webkit-appearance: none;
      -moz-appearance: none;
      appearance: none;
    }

    .color-info-accordion-button:hover {
      padding: 8px 12px;
      color: #333;
      text-decoration: none;
      background: transparent;
      border: none;
      box-shadow: none;
      border-radius: 0;
    }

    .color-info-accordion-button:focus {
      background: transparent;
      border: none;
      box-shadow: none;
    }

    .color-info-accordion-button:active {
      background: transparent;
      border: none;
      box-shadow: none;
      transform: none;
    }

    .color-info-accordion-content-wrapper {
      display: flex;
      align-items: center;
      gap: 8px;
      margin: 0;
      padding: 0;
      border: none;
      background: transparent;
      flex: 1;
      min-width: 0;
    }

    .color-info-accordion-icon {
      width: 16px;
      height: 16px;
      min-width: 16px;
      min-height: 16px;
      flex-shrink: 0;
      margin: 0;
      padding: 0;
      border: none;
      background: transparent;
      stroke: currentColor;
      stroke-width: 2;
      stroke-linecap: round;
      stroke-linejoin: round;
      fill: none;
      display: block;
    }

    .color-info-accordion-text {
      margin: 0;
      padding: 0;
      border: none;
      background: transparent;
      font-family: var(--pfd-font-family);
      font-size: 14px;
      font-weight: 500;
      line-height: 1.4;
      color: #666;
      flex: 1;
      min-width: 0;
    }

    .color-info-accordion-text .color-ring-emphasis {
      font-weight: 600;
      color: #333;
      text-decoration: underline;
      text-underline-offset: 2px;
      white-space: nowrap;
      cursor: pointer;
      transition: color 0.2s ease;
    }

    .color-info-accordion-text .color-ring-emphasis:hover {
      color: #000;
      text-decoration: underline;
    }

    .color-info-accordion-text .color-ring-emphasis:focus {
      outline: 2px solid #333;
      outline-offset: 2px;
      border-radius: 2px;
    }

    .color-info-accordion-chevron {
      width: 16px;
      height: 16px;
      min-width: 16px;
      min-height: 16px;
      flex-shrink: 0;
      margin: 0;
      padding: 0;
      border: none;
      background: transparent;
      stroke: currentColor;
      stroke-width: 2;
      stroke-linecap: round;
      stroke-linejoin: round;
      fill: none;
      transition: transform 0.2s ease;
      display: block;
    }

    .color-info-accordion-button[data-state='open'] .color-info-accordion-chevron {
      transform: rotate(180deg);
    }

    .color-info-accordion-content {
      overflow: hidden;
      margin: 0;
      padding: 0;
      border: none;
      background: transparent;
      font-family: var(--pfd-font-family);
      font-size: 14px;
      line-height: 1.4;
      color: #666;
      max-height: 0;
      opacity: 0;
      transition:
        max-height 0.2s ease,
        opacity 0.2s ease;
    }

    .color-info-accordion-content[data-state='open'] {
      max-height: 200px;
      opacity: 1;
    }

    .color-info-accordion-content-inner {
      padding: 8px 0 0 0;
      margin: 0;
      border: none;
      background: transparent;
    }

    .color-info-accordion-text-content {
      margin: 0;
      padding: 0 0 0 16px;
      border: none;
      border-left: 2px solid #e5e5e5;
      background: transparent;
      font-family: var(--pfd-font-family);
      font-size: 14px;
      font-weight: 400;
      font-style: italic;
      line-height: 1.625;
      color: #666;
      text-align: left;
    }

    /* Animation classes for smooth transitions */
    .color-info-accordion-content.animating {
      transition:
        max-height 0.3s ease,
        opacity 0.3s ease;
    }

    /* Reset any potential theme interference */
    .color-info-accordion-container {
      margin: 0;
      padding: 0;
      border: none;
      background: transparent;
      box-shadow: none;
      border-radius: 0;
    }

    .color-info-accordion svg path {
      stroke: currentColor;
      fill: none;
      stroke-width: 2;
      stroke-linecap: round;
      stroke-linejoin: round;
    }
  </style>

  <div class="color-info-accordion-container" data-state="closed">
    <h3>
      <button
        type="button"
        class="color-info-accordion-button"
        data-accordion-trigger
        data-state="closed"
        aria-expanded="false"
      >
        <span class="color-info-accordion-content-wrapper">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            class="color-info-accordion-icon"
          >
            <path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"></path>
            <path d="M12 9v4"></path>
            <path d="M12 17h.01"></path>
          </svg>
          <span class="color-info-accordion-text"
            >For perfect color matching, order a
            <a href="https://dropdeadextensions.com/products/color-ring-2-0" class="color-ring-emphasis">Color Ring</a
            >.</span
          >
        </span>
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          class="color-info-accordion-chevron"
        >
          <path d="m6 9 6 6 6-6"></path>
        </svg>
      </button>
    </h3>
    <div
      class="color-info-accordion-content"
      data-accordion-content
      data-state="closed"
    >
      <div class="color-info-accordion-content-inner">
        <p class="color-info-accordion-text-content">
          Our color levels are intentionally designed to differ from traditional swatch books. While most systems
          cluster dark levels and then jump into blondes, we created a smoother, more linear level system from 1 through
          10 for a more predictable graduation across shades.
        </p>
      </div>
    </div>
  </div>

  <script>
    (function () {
      // Find all color info accordions on the page
      const accordions = document.querySelectorAll('[data-color-accordion]');

      accordions.forEach(function (accordion) {
        const trigger = accordion.querySelector('[data-accordion-trigger]');
        const content = accordion.querySelector('[data-accordion-content]');
        const container = accordion.querySelector('.color-info-accordion-container');

        if (!trigger || !content || !container) return;

        // Set initial state
        let isOpen = false;

        function updateState(open) {
          isOpen = open;
          const state = open ? 'open' : 'closed';

          trigger.setAttribute('data-state', state);
          trigger.setAttribute('aria-expanded', open.toString());
          content.setAttribute('data-state', state);
          container.setAttribute('data-state', state);

          // Add animation class for smooth transitions
          content.classList.add('animating');

          // Remove animation class after transition completes
          setTimeout(function () {
            content.classList.remove('animating');
          }, 300);
        }

        // Handle click events
        trigger.addEventListener('click', function (e) {
          // Don't prevent default if clicking on the Color Ring link
          if (e.target.classList.contains('color-ring-emphasis')) {
            // Allow the link to work normally
            return;
          }
          e.preventDefault();
          updateState(!isOpen);
        });

        // Handle keyboard events for accessibility
        trigger.addEventListener('keydown', function (e) {
          // Don't handle if focus is on the Color Ring link
          if (e.target.classList.contains('color-ring-emphasis')) {
            return;
          }
          if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            updateState(!isOpen);
          }
        });
      });
    })();
  </script>
</div>
