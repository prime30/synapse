# Supabase Configuration
# Get these from your Supabase project settings: https://app.supabase.com
NEXT_PUBLIC_SUPABASE_URL=
NEXT_PUBLIC_SUPABASE_ANON_KEY=
SUPABASE_SERVICE_ROLE_KEY=

# AI Provider API Keys
# Anthropic: https://console.anthropic.com/ → API Keys (starts with sk-ant-)
# OpenAI: https://platform.openai.com/api-keys
# Google AI Studio: https://aistudio.google.com/apikey
# If you see "invalid API key" or "AI is not configured": use a new key from the provider dashboard; ensure no extra spaces/quotes and the key is in .env.local (not only .env).
ANTHROPIC_API_KEY=
OPENAI_API_KEY=
GOOGLE_AI_API_KEY=

# Google Vertex AI (optional — when set, the Google provider uses Vertex AI instead of the Gemini Developer API)
# Auth: Application Default Credentials (ADC) — run `gcloud auth application-default login`
# or set GOOGLE_APPLICATION_CREDENTIALS to a service-account key file.
VERTEX_PROJECT_ID=
VERTEX_LOCATION=us-central1
# Fallback aliases (SDK convention):
# GOOGLE_CLOUD_PROJECT=
# GOOGLE_CLOUD_LOCATION=

# ── Google Media Generation (Vertex AI Studio) ──────────────────────
# Uses the same GOOGLE_AI_API_KEY above. Models:
#   Image: gemini-3-pro-image-preview (Nano Banana Pro) -- up to 4K, text rendering, 14 ref images
#   Video: veo-3.1-generate-preview (Veo 3.1) -- 4-8s clips, 720p/1080p, native audio
# Set to 'true' to expose media generation in the UI and MCP tools.
NEXT_PUBLIC_ENABLE_MEDIA_GENERATION=false

# ── Google Media Generation (Vertex AI Studio) ─────────────────────
# Same GOOGLE_AI_API_KEY above powers all three:
#   - Gemini 3 Flash (code generation with thinking levels)
#   - Nano Banana Pro / gemini-3-pro-image-preview (image generation)
#   - Veo 3.1 / veo-3.1-generate-preview (video generation)
# Set to 'true' to show these features are available in the UI.
NEXT_PUBLIC_HAS_GOOGLE=true

# Application Configuration
# Production: https://synapse.shop (no trailing slash)
NEXT_PUBLIC_APP_URL=http://localhost:3000

# Shopify OAuth (required for "Connect with Shopify" one-click button)
# Create a Shopify app in your Partner Dashboard or store admin.
# API Key = Client ID, API Secret = Client Secret.
SHOPIFY_API_KEY=
SHOPIFY_API_SECRET=

# Shopify token encryption (optional -- falls back to SUPABASE_SERVICE_ROLE_KEY hash)
# 32-byte hex string for AES-256-CBC encryption of Shopify access tokens.
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
# SHOPIFY_ENCRYPTION_KEY=

# Shopify dev theme provisioning (optional)
# Public URL to a Shopify theme ZIP used when creating a dev theme per project.
# e.g. a GitHub release asset or other public zip URL.
SHOPIFY_DEV_THEME_ZIP_URL=

# Gorgias Chat Widget (optional)
# Get your Chat App ID from Gorgias: Settings > Chat > Installation
# Enables live chat in the in-app support panel.
NEXT_PUBLIC_GORGIAS_CHAT_ID=

# Gorgias API (optional, for support ticket forwarding)
# GORGIAS_DOMAIN=yourstore.gorgias.com
# GORGIAS_API_KEY=

# Support webhook (optional, fallback for ticket forwarding)
# SUPPORT_WEBHOOK_URL=

# Stripe (Billing)
# Get these from https://dashboard.stripe.com/apikeys
STRIPE_SECRET_KEY=
STRIPE_WEBHOOK_SECRET=
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=

# Overage metered price (Stripe Dashboard: Products → Overage Usage → Usage-based, $0.01/unit)
STRIPE_PRICE_OVERAGE_METERED=

# Margin: charge = cost * OVERAGE_MARKUP_MULTIPLIER (min 1.0)
OVERAGE_MARKUP_MULTIPLIER=2.0

# Cron (Vercel sends Authorization: Bearer CRON_SECRET to cron endpoints)
CRON_SECRET=

# Transactional Email (Resend)
# Get from https://resend.com/api-keys
RESEND_API_KEY=

# BYOK Encryption Key
# 32-byte hex string for AES-256-GCM encryption of user API keys
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
ENCRYPTION_KEY=

# Dev Auto-Login (development only)
# Create a user in your Supabase project, then add credentials here
# to skip the sign-in screen entirely during local development.
DEV_AUTO_LOGIN_EMAIL=
DEV_AUTO_LOGIN_PASSWORD=

# ── Upstash Redis (optional -- caching + rate limiting) ──────────────
# Get these from https://console.upstash.com
# When unset, all caches fall back to in-memory Map (fine for local dev).
UPSTASH_REDIS_REST_URL=
UPSTASH_REDIS_REST_TOKEN=
# Set to 'redis' or 'memory' to show cache backend in StatusBar (informational)
NEXT_PUBLIC_CACHE_BACKEND=memory

# ── AI Feature Flags ────────────────────────────────────────────────
# All default to false. Set to 'true' to enable each feature.
ENABLE_PROMPT_CACHING=true
ENABLE_ADAPTIVE_THINKING=false
ENABLE_STRUCTURED_OUTPUTS=false
ENABLE_STREAMING_TOOL_USE=false
ENABLE_CITATIONS=false
ENABLE_BATCH_PROCESSING=false
ENABLE_PM_EXPLORATION_TOOLS=false
ENABLE_CONDITIONAL_SUMMARY=true
ENABLE_V2_AGENT=false
NEXT_PUBLIC_ENABLE_V2_AGENT=false
ENABLE_VECTOR_SEARCH=false
ENABLE_OBSERVABILITY=false
ENABLE_PTC=true
ENABLE_CONTEXT_EDITING=false

# ── Prompt Cache TTL ──────────────────────────────────────────────
# '5m' (default free refresh) or '1h' (2x write cost, same read cost)
PROMPT_CACHE_TTL=1h

# ── Local Sync ─────────────────────────────────────────────────────
# Set to '1' to enable local filesystem sync (pulls themes to .synapse-themes/).
# When enabled, local edits auto-push to the Shopify dev theme.
NEXT_PUBLIC_ENABLE_LOCAL_SYNC=0
# Set to '1' to disable the file watcher (e.g. while running benchmark/agent to prevent Synapse from hard-reloading).
# DISABLE_FILE_WATCHER=0

# Debug: log all tool_start/tool_end events during streaming (dev only)
# DEBUG_TOOLS=false

# ── Benchmark: production Cursor ────────────────────────────────────
# Run v2-live-benchmark with real Cursor agent (Headless CLI) instead of API simulation.
# Requires: Cursor CLI installed (https://cursor.com/docs/cli), API key from Cursor Dashboard → Integrations.
# If Cursor reports "invalid API key": create a new key in Cursor (Settings → Integrations), paste here with no extra spaces/quotes.
# On Windows, if you see "agent is not recognized": set CURSOR_AGENT_PATH to the full path to agent.exe (e.g. where Cursor CLI installed it).
# CURSOR_AGENT_PATH=
# If Cursor CLI hangs (e.g. indexing): CURSOR_SKIP_PRODUCTION=1 skips running the CLI and keeps existing Cursor data from the last benchmark file.
# CURSOR_SKIP_PRODUCTION=0
# Per-run timeout (minutes): CURSOR_RUN_TIMEOUT_MIN=10 (default). On Windows the CLI often needs 15+ (indexing). If you still get 0 tokens and timeout, run the benchmark under WSL.
# Optional: prime the index once before the benchmark so Cursor may skip indexing during runs: npm run cursor:index (stops after 2 min; use --timeout=3 for 3 min).
# No-output fail (minutes): CURSOR_NO_OUTPUT_FAIL_MIN=12 (default). First run can take 3–5 min while CLI indexes; increase if you see stderr progress (indexing) and it’s not hung. Add *.min.js, *.min.css, locales/ to theme-workspace/.cursorignore to speed indexing.
# RUN_LIVE_AGENT_TESTS=true
# BENCHMARK_RUNS_PER_PROMPT=3
# CURSOR_PRODUCTION=1
# After a timeout, run only missing scenarios and merge: BENCHMARK_SCENARIOS=arch-rebuild,compound-quickview,crossfile-consistency (keys: trivial-color, simple-ask, complex-section, arch-rebuild, compound-quickview, crossfile-consistency)
# BENCHMARK_SCENARIOS=
CURSOR_API_KEY=
